SetTitleMatchMode, 2
#SingleInstance force
#ifwinactive C:\Users\stroketip\Desktop\ショートカット\ShogiGUIv0.
f::
{
	x=歩
	shogitxt(x)
	return
}
h::
{
	x=飛
	shogitxt(x)
	return
}
x::
{
	x=角
	shogitxt(x)
	return
}
g::
{
	x=銀
	shogitxt(x)
	return
}

k::
{
	x=金
	shogitxt(x)
	return
}

r::
{
	x=竜
	shogitxt(x)
	return
}

u::
{
	x=馬
	shogitxt(x)
	return
}

e::
`;::
{
	x=桂
	shogitxt(x)
	return
}
o::
{
	x=王
	shogitxt(x)
	return
}

l::
{
	x=香
	shogitxt(x)
	return
}

t::
{
	x=と
	shogitxt(x)
	return
}

y::
.::
{
	x=杏
	shogitxt(x)
	return
}

p::
/::
{
	x=圭
	shogitxt(x)
	return
}
b::
d::
{
	x=全
	shogitxt(x)
	return
}



w::
q::
space::
{
	x=・
	shogitxt(x)
	return
}
+f::
{
	send,v
	x=歩
	shogitxt(x)
	return
}

+g::
{
	send,v
	x=銀
	shogitxt(x)
	return
}

+k::
{
	send,v
	x=金
	shogitxt(x)
	return
}

+r::
{
	send,v
	x=竜
	shogitxt(x)
	return
}

+u::
{
	send,v
	x=馬
	shogitxt(x)
	return
}

+e::
{
	send,v
	x=桂
	shogitxt(x)
	return
}
+o::
{
	send,v
	x=王
	shogitxt(x)
	return

}

+l::
{
	send,v
	x=香
	shogitxt(x)

	return
}

+t::
{
	send,v
	x=と
	shogitxt(x)

	return
}

+y::
+.::
{
	send,v
	x=杏
	shogitxt(x)
	return
}

+p::
+/::
{
	send,v
	x=圭
	shogitxt(x)
	return
}

+d::
+b::
{
	send,v
	x=全
	shogitxt(x)
	return
}
+h::
{
	send,v
	x=飛
	shogitxt(x)
	return
}
+x::
{
	send,v
	x=角
	shogitxt(x)
	return
}

+enter::
+tab::
{
	send,{right 4}
	return
}

:*:ac::
{
	send,^{home}
	
	send,{right 6}
	send,+{end}
	send,+{left}
	send,{del}
	
	send,{down 13}
	send,+{end}

	send,{del}
	
	send,^{home}
	
	send,{down 3}
	send,{right}
	loop 9
	
	{
	send,+{end}
	send,+{left 2}
	send,{bs}
	send,{down}
	}
	
	send,{up 9}
	return
}

vk1Dsc07B & l::
{
	send,{right 4}
	return
}
1::
numpad1::
{
	x=一
	shogitxt(x)
	return
}
2::
numpad2::
{
	x=二
	shogitxt(x)
	return
}
3::
numpad3::
{
	x=三
	shogitxt(x)
	return
}
4::
numpad4::
{
	x=四
	shogitxt(x)
	return
}
5::
numpad5::
{
	x=五
	shogitxt(x)
	return
}
6::
numpad6::
{
	x=六
	shogitxt(x)
	return
}
7::
numpad7::
{
	x=七
	shogitxt(x)
	return
}
8::
numpad8::
{
	x=八
	shogitxt(x)
	return
}
9::
numpad9::
{
	x=九
	shogitxt(x)
	return
}
0::
numpad0::
{
	x=十
	shogitxt(x)
	return
}

m::
{
	send,^{home}
	send,{right 6}
	return
}

+m::
{
	send,^{home}
	send,{down 13}
	send,{right 6}
	return
}


shogitxt(stxt)
{
	clipboard_backup = %ClipboardAll%
	clipboard=
	
	clipboard := stxt
	clipwait,1
	sleep,100
	send,^v
	
	Clipboard := clipboard_backup
}

^m::
{
	
fu=18
kyou=4
kei=4

kin=4
gin=4
hisha=2
kaku=2
ou=2

	komaflag =0

send,^a
send,^c

komacount := clipboard
;stringtrimleft,komacount,komacount,5
/*
foundpos := regexmatch(komacount,"`r")
msgbox,%foundpos%
*/


loop,14
{
	komacount := regexmatch(clipboard,"`r")
stringleft,line%a_index%,clipboard,komacount
stringtrimleft,clipboard,clipboard,komacount

;msgbox,line%a_index%


}

bankoma=%line4%%line5%%line6%%line7%%line8%%line9%%line10%%line11%%line12%
komakey:= bankoma


loop,2000
{
stringleft,komatop,komakey,1
stringtrimleft,komakey,komakey,1

if(komatop="歩") or (komatop="と")
{
	fu--
;	msgbox,%fu%
}

if(komatop="香") or (komatop="杏")
{
	kyou--
;	msgbox,%kyou%
}

if(komatop="桂") or (komatop="圭")
{
	kei--
;	msgbox,%kei%
}

if(komatop="銀") or (komatop="全")
{
	gin--
;	msgbox,%kei%
}
if(komatop="金")
{
	kin--
;	msgbox,%kin%
}
if(komatop="角") or (komatop="馬")
{
	kaku--
;	msgbox,%kaku%
}
if(komatop="飛") or (komatop="竜")
{
	hisha--
;	msgbox,%hisha%
}
if(komatop="王") or (komatop="玉")
{
	ou--
;	msgbox,%ou%
}
if(komatop="九")
{
	break
}
}



sentemotigoma := line14


loop,2000
{
stringleft,komatop,sentemotigoma,1
stringtrimleft,sentemotigoma ,sentemotigoma,1

if(komatop="歩")
{
	komaflag=1
;	msgbox,%fu%
}

if(komatop="香")
{
	komaflag=2
;	msgbox,%kyou%
}

if(komatop="桂")
{
	komaflag=3
;	msgbox,%kei%
}

if(komatop="銀")
{
	komaflag=4
;	msgbox,%kei%
}
if(komatop="金")
{
	komaflag=5
;	msgbox,%kin%
}
if(komatop="角")
{
	komaflag=6
;	msgbox,%kaku%
}
if(komatop="飛")
{
	komaflag=7
;	msgbox,%hisha%
}
if(komatop="王")
{
	komaflag=8
;	msgbox,%ou%
}
if(komatop="一")
{
;	komakazu=1
	if(komaflag = 1)
	{
		fu--
	}
	if(komaflag = 2)
	{
		kyou--
	}
	if(komaflag = 3)
	{
		kei--
	}	
	if(komaflag = 4)
	{
		gin--
	}	
	if(komaflag = 5)
	{
		kin--
	}	
	if(komaflag = 6)
	{
		kaku--
	}	
	if(komaflag = 7)
	{
		hisha--
	}	

	komaflag =0
}

if(komatop="二")
{
	
;	komakazu=1
	if(komaflag = 1)
	{
		fu-=2
	}
	if(komaflag = 2)
	{
		kyou-=2
	}
	if(komaflag = 3)
	{
		kei-=2
	}	
	if(komaflag = 4)
	{
		gin-=2
	}	
	if(komaflag = 5)
	{
		kin-=2
	}	
	if(komaflag = 6)
	{
		kaku-=2
	}	
	if(komaflag = 7)
	{
		hisha-=2
	}	

	komaflag =0

}

if(komatop="三")
{
;	komakazu=3

	if(komaflag = 1)
	{
		fu-=3
	}
	if(komaflag = 2)
	{
		kyou-=3
	}
	if(komaflag = 3)
	{
		kei-=3
	}	
	if(komaflag = 4)
	{
		gin-=3
	}	
	if(komaflag = 5)
	{
		kin-=3
	}	
	if(komaflag = 6)
	{
		kaku-=3
	}	
	if(komaflag = 7)
	{
		hisha-=3
	}	

	komaflag =0


}

if(komatop="四")
{
	
;	komakazu=1
	if(komaflag = 1)
	{
		fu-=4
	}
	if(komaflag = 2)
	{
		kyou-=4
	}
	if(komaflag = 3)
	{
		kei-=4
	}	
	if(komaflag = 4)
	{
		gin-=4
	}	
	if(komaflag = 5)
	{
		kin-=4
	}	
	if(komaflag = 6)
	{
		kaku-=4
	}	
	if(komaflag = 7)
	{
		hisha-=4
	}	

	komaflag =0

}

if(komatop="五")
{
	
;	komakazu=1
	if(komaflag = 1)
	{
		fu-=5
	}
	if(komaflag = 2)
	{
		kyou-=5
	}
	if(komaflag = 3)
	{
		kei-=5
	}	
	if(komaflag = 4)
	{
		gin-=5
	}	
	if(komaflag = 5)
	{
		kin-=5
	}	
	if(komaflag = 6)
	{
		kaku-=5
	}	
	if(komaflag = 7)
	{
		hisha-=5
	}	

	komaflag =0

}

if(komatop="六")
{
	
;	komakazu=1
	if(komaflag = 1)
	{
		fu-=6
	}
	if(komaflag = 2)
	{
		kyou-=6
	}
	if(komaflag = 3)
	{
		kei-=6
	}	
	if(komaflag = 4)
	{
		gin-=6
	}	
	if(komaflag = 5)
	{
		kin-=6
	}	
	if(komaflag = 6)
	{
		kaku-=6
	}	
	if(komaflag = 7)
	{
		hisha-=6
	}	

	komaflag =0

}

if(komatop="七")
{
	
;	komakazu=1
	if(komaflag = 1)
	{
		fu-=7
	}
	if(komaflag = 2)
	{
		kyou-=7
	}
	if(komaflag = 3)
	{
		kei-=7
	}	
	if(komaflag = 4)
	{
		gin-=7
	}	
	if(komaflag = 5)
	{
		kin-=7
	}	
	if(komaflag = 6)
	{
		kaku-=7
	}	
	if(komaflag = 7)
	{
		hisha-=7
	}	

	komaflag =0

}

if(komatop="八")
{
	
;	komakazu=1
	if(komaflag = 1)
	{
		fu-=8
	}
	if(komaflag = 2)
	{
		kyou-=8
	}
	if(komaflag = 3)
	{
		kei-=8
	}	
	if(komaflag = 4)
	{
		gin-=8
	}	
	if(komaflag = 5)
	{
		kin-=8
	}	
	if(komaflag = 6)
	{
		kaku-=8
	}	
	if(komaflag = 7)
	{
		hisha-=8
	}	

	komaflag =0

}

if(komatop="九")
{
	
;	komakazu=1
	if(komaflag = 1)
	{
		fu-=9
	}
	if(komaflag = 2)
	{
		kyou-=9
	}
	if(komaflag = 3)
	{
		kei-=9
	}	
	if(komaflag = 4)
	{
		gin-=9
	}	
	if(komaflag = 5)
	{
		kin-=9
	}	
	if(komaflag = 6)
	{
		kaku-=9
	}	
	if(komaflag = 7)
	{
		hisha-=9
	}	

	komaflag =0

}

if(komatop="`r")
{
	break
}
}


if(fu=0)
{
	gotemotigoma=
}
if(fu=1)
{
	gotemotigoma=歩一
}
if(fu=2)
{
	gotemotigoma=歩二
}
if(fu=3)
{
	gotemotigoma=歩三
}
if(fu=4)
{
	gotemotigoma=歩四
}
if(fu=5)
{
	gotemotigoma=歩五
}
if(fu=6)
{
	gotemotigoma=歩六
}
if(fu=7)
{
	gotemotigoma=歩七
}
if(fu=8)
{
	gotemotigoma=歩八
}
if(fu=9)
{
	gotemotigoma=歩九
}
if(fu=10)
{
	gotemotigoma=歩十
}
if(fu=11)
{
	gotemotigoma=歩十一
}
if(fu=12)
{
	gotemotigoma=歩十二
}
if(fu=13)
{
	gotemotigoma=歩十三
}
if(fu=14)
{
	gotemotigoma=歩十四
}
if(fu=15)
{
	gotemotigoma=歩十五
}
if(fu=16)
{
	gotemotigoma=歩十六
}
if(fu=17)
{
	gotemotigoma=歩十七
}
if(fu=18)
{
	gotemotigoma=歩十八
}

if(kyou=0)
{
}
if(kyou=1)
{
	gotemotigoma=%gotemotigoma% 香一
}
if(kyou=2)
{
	gotemotigoma=%gotemotigoma% 香二
}
if(kyou=3)
{
	gotemotigoma=%gotemotigoma% 香三
}
if(kyou=4)
{
	gotemotigoma=%gotemotigoma% 香四
}

if(kei=0)
{
}
if(kei=1)
{
	gotemotigoma=%gotemotigoma% 桂一
}
if(kei=2)
{
	gotemotigoma=%gotemotigoma% 桂二
}
if(kei=3)
{
	gotemotigoma=%gotemotigoma% 桂三
}
if(kei=4)
{
	gotemotigoma=%gotemotigoma% 桂四
}

if(gin=0)
{
}
if(gin=1)
{
	gotemotigoma=%gotemotigoma% 銀一
}
if(gin=2)
{
	gotemotigoma=%gotemotigoma% 銀二
}
if(gin=3)
{
	gotemotigoma=%gotemotigoma% 銀三
}
if(gin=4)
{
	gotemotigoma=%gotemotigoma% 銀四
}

if(kin=0)
{
}
if(kin=1)
{
	gotemotigoma=%gotemotigoma% 金一
}
if(kin=2)
{
	gotemotigoma=%gotemotigoma% 金二
}
if(kin=3)
{
	gotemotigoma=%gotemotigoma% 金三
}
if(kin=4)
{
	gotemotigoma=%gotemotigoma% 金四
}

if(kaku=0)
{
}
if(kaku=1)
{
	gotemotigoma=%gotemotigoma% 角一
}
if(kaku=2)
{
	gotemotigoma=%gotemotigoma% 角二
}

if(hisha=0)
{
}
if(hisha=1)
{
	gotemotigoma=%gotemotigoma% 飛一
}
if(hisha=2)
{
	gotemotigoma=%gotemotigoma% 飛二
}

gotemotigoma=後手の持駒：%gotemotigoma%

clipboard_backup = %ClipboardAll%
clipboard:=gotemotigoma
sleep,100
send,^{home}
sleep,100
send,+{end}
sleep,100
send,^v
Clipboard := clipboard_backup


/*
msgbox,fu=%fu%`rkyou=%kyou%`rkei=%kei%`rgin=%gin%`rkin=%kin%`rkaku=%kaku%`rhisha=%hisha%`rou=%ou%`r
*/

/*
msgbox,%line1%
msgbox,%line2%
msgbox,%line3%
msgbox,%line4%
msgbox,%line5%
msgbox,%line6%
msgbox,%line7%
msgbox,%line8%
msgbox,%line9%
msgbox,%line10%
msgbox,%line11%
msgbox,%line12%
msgbox,%line13%
msgbox,%line14%
*/
;foundpos := regexmatch(komacount,"`r")


return
}
